<!DOCTYPE html>
<html>
<head>
    <title>Cart Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-info { background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .step { margin: 10px 0; padding: 10px; border-left: 3px solid #007bff; }
        .expected { color: #28a745; }
        .issue { color: #dc3545; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>🛒 Cart Debug Test</h1>
    
    <div class="debug-info">
        <h3>Debug Instructions:</h3>
        <ol>
            <li>Open the customer app using the button below</li>
            <li>Open browser Developer Tools (F12)</li>
            <li>Go to the Console tab</li>
            <li>Navigate to a menu item and click "Add" multiple times</li>
            <li>Watch for these console logs:</li>
            <ul>
                <li><code>🛒 ADD TO CART:</code> - Shows what's being added</li>
                <li><code>📦 Current cart items:</code> - Shows existing cart</li>
                <li><code>🔍 Comparing:</code> - Shows ID comparison</li>
                <li><code>🎛️ Options comparison:</code> - Shows options comparison</li>
                <li><code>📍 Existing item index:</code> - Shows if item was found (-1 = not found)</li>
                <li><code>➕ Updating quantity:</code> - Shows quantity increment</li>
                <li><code>🆕 Adding new item:</code> - Shows new item addition</li>
                <li><code>🔢 Cart count calculation:</code> - Shows final count</li>
            </ul>
        </ol>
    </div>
    
    <div>
        <button onclick="window.open('http://localhost:5173', '_blank')" style="background: #007bff; color: white; border: none; border-radius: 5px;">
            🚀 Open Customer App
        </button>
    </div>
    
    <div class="step">
        <h3 class="expected">✅ Expected Behavior:</h3>
        <ul>
            <li>First click: Cart count = 1</li>
            <li>Second click: Cart count = 2 (quantity increment)</li>
            <li>Third click: Cart count = 3 (quantity increment)</li>
        </ul>
    </div>
    
    <div class="step">
        <h3 class="issue">❌ Current Issue:</h3>
        <p>Cart count showing incorrect value on second click</p>
    </div>
    
    <div class="step">
        <h3>🔍 What to Look For:</h3>
        <ul>
            <li><strong>ID Mismatch:</strong> Different IDs being compared</li>
            <li><strong>Options Mismatch:</strong> Different options causing new items</li>
            <li><strong>State Race Condition:</strong> Updates happening before cart loads</li>
            <li><strong>Duplicate Items:</strong> Multiple entries instead of quantity increment</li>
        </ul>
    </div>
    
    <div class="debug-info">
        <h3>Common Issues:</h3>
        <ul>
            <li><strong>Size Variants:</strong> Product might be adding size options automatically</li>
            <li><strong>ID Format:</strong> IDs might be different types (string vs ObjectId)</li>
            <li><strong>localStorage Timing:</strong> Cart not loaded when adding items</li>
            <li><strong>React State Batching:</strong> Multiple state updates causing issues</li>
        </ul>
    </div>
</body>
</html>
